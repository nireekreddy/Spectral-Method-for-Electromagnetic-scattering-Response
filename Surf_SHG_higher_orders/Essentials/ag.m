%ag.m
%calculates silver dielectric constant as function of wavelength
function ageps=ag(lam);
xev=[6.6 6.47 6.35 6.22 6.10 5.98 5.85 5.73 5.60,5.48,5.36,5.23,5.11,4.98,4.86,4.74,4.61,4.49,4.36,4.24,4.12,3.99,3.87,3.74,3.62,3.5,3.37,3.25,3.12,3.0,2.88,2.75,2.63,2.50,2.38,2.26,2.13,2.01,1.88,1.76,1.64,1.51,1.39,1.26,1.14,1.02,0.89,0.77,0.64];
%lxev=length(xev)
x=1.25./xev;
n=[1.07 1.10 1.12 1.14 1.15 1.18 1.20 1.22 1.25 1.26 1.28 1.28 1.30 1.31 1.33 1.35 1.38 1.41 1.41 1.39 1.34 1.13 0.81 0.17 0.14 0.1 0.07 0.05 0.05 0.05 0.04 0.04 0.05 0.05 0.05 0.06 0.05 0.06 0.05 0.04 0.03 0.04 0.04 0.04 0.04 0.09 0.13 0.15 0.24];
%ln=length(n)
ka=[1.212 1.232 1.255 1.277 1.296 1.312 1.325 1.336 1.342 1.344 1.357 1.367 1.378 1.389 1.393 1.387 1.372 1.331 1.264 1.161 0.964 .616 .392 .829 1.142 1.419 1.657 1.864 2.070 2.275 2.462 2.657 2.869 3.093 3.324 3.586 3.858 4.152 4.483 4.838 5.242 5.727 6.312 6.992 7.795 8.828 10.10 11.85 14.08];
%lka=length(ka)
nr=interp1(x,n,lam,'spline');
ni=interp1(x,ka,lam,'spline');
agn=nr+i*ni;
ageps=(nr+i*ni).^2;